#!/bin/sh
# Browser selector, like a rudimentary xdg-open.

run_browser() {
	B="$1"
	shift
	if [ ! -z "$B" ]; then
		hasbin "$B" && exec "$B" "$@"
		$B "$@"
		exit $?
	fi
}

check_browser() {
	B="$1"
	shift
	hasbin "$B" && exec "$B" "$@"
}


if [ "$(uname)" = "Darwin" ]; then
	open "$@"
elif graphical any; then
	run_browser "$GBROWSER" "$@"
	for browser in luakit waterfox firefox google-chrome dwb; do
		check_browser "$browser" "$@"
	done
else
	run_browser "$BROWSER" "$@"
	for browser in w3m elinks lynx links2 termux-open-url; do
		check_browser "$browser" "$@"
	done
fi

echo "No browser available."
exit 1
